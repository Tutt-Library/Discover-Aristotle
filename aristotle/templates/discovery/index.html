{% extends 'discovery/base.html' %}

{% block more_css %}
 
{% endblock %}

{% block library_breadcrumb %}
 <div id="breadcrumb"></div>
{% endblock %}

{% block results_detail %}
{% endblock %}


{% block results_list %}
{% endblock %}


{% block more_scripts %}
{# comment %}
<script src="{{ STATIC_URL }}js/jquery.js"></script>
{% endcomment #}
<script src="{{ url_for('static', filename='js/discovery.js') }}"></script>
{#<script src="{{ STATIC_URL }}js/google-analytics.js"></script>#}
<script>
 $(function() {
   $("#cart-dlg").on('show', function() {
     ShowCart("{{ session_id }}")
   });
 });
 var viewModel = new simpleViewModel();
 ko.applyBindings(viewModel);
 if(viewModel.searchResults().length < 1) {
	 viewModel.initDisplay("{{ pid }}");
 
 }

 $(window).scroll(function() {
		 if ($(window).scrollTop() + $(window).height() >= $(document).height()) {
				 var new_offset = viewModel.fromOffset() + viewModel.searchResults().length;
                 if (new_offset >= viewModel.totalHits()) {
                     console.log("No more hits");
					 return;
                 }
				 $.ajax({
						 method: "GET",
						 data: { from: new_offset,
								 size: viewModel.shardSize(),
								 query: viewModel.searchQuery() },
						 url: "/search",
						 success: function(data) {
                             console.log("Successful search " + data);

						 }
				

				 });
    }
});
</script>
{% endblock more_scripts %}

{% block dialogs %}
<div id="search_dialog" class="modal hide">
{% include 'discovery/snippets/search_history_dialog.html' %}
</div>
<div id="cart-dlg" class="modal hide">
{% include 'discovery/snippets/cart_dialog.html' %}
</div>
{% endblock %}
